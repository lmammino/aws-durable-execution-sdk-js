<!-- Do not edit this file. It is automatically generated by API Documenter. -->

[Home](./index.md) &gt; [@aws/durable-execution-sdk-js](./durable-execution-sdk-js.md) &gt; [withDurableExecution](./durable-execution-sdk-js.withdurableexecution.md)

## withDurableExecution() function

Wraps a durable handler function to create a handler with automatic state persistence, retry logic, and workflow orchestration capabilities.

This function transforms your durable handler into a function that integrates with the AWS Durable Execution service. The wrapped handler automatically manages execution state and checkpointing.

**Signature:**

```typescript
withDurableExecution: <
  TEvent = any,
  TResult = any,
  TLogger extends DurableLogger = DurableLogger,
>(
  handler: DurableExecutionHandler<TEvent, TResult, TLogger>,
  config?: DurableExecutionConfig,
) => DurableLambdaHandler;
```

## Parameters

<table><thead><tr><th>

Parameter

</th><th>

Type

</th><th>

Description

</th></tr></thead>
<tbody><tr><td>

handler

</td><td>

[DurableExecutionHandler](./durable-execution-sdk-js.durableexecutionhandler.md)<!-- -->&lt;TEvent, TResult, TLogger&gt;

</td><td>

Your durable handler function that uses the DurableContext for operations

</td></tr>
<tr><td>

config

</td><td>

[DurableExecutionConfig](./durable-execution-sdk-js.durableexecutionconfig.md)

</td><td>

_(Optional)_ Optional configuration for custom advanced settings

</td></tr>
</tbody></table>

**Returns:**

[DurableLambdaHandler](./durable-execution-sdk-js.durablelambdahandler.md)

A handler function that automatically manages durability

## Example 1

\*\*Basic Usage:\*\*

```typescript
import {
  withDurableExecution,
  DurableExecutionHandler,
} from "@aws/durable-execution-sdk-js";

const durableHandler: DurableExecutionHandler<MyEvent, MyResult> = async (
  event,
  context,
) => {
  // Execute durable operations with automatic retry and checkpointing
  const userData = await context.step("fetch-user", async () =>
    fetchUserFromDB(event.userId),
  );

  // Wait for external approval
  const approval = await context.waitForCallback(
    "user-approval",
    async (callbackId) => {
      await sendApprovalEmail(callbackId, userData);
    },
  );

  // Process in parallel
  const results = await context.parallel("process-data", [
    async (ctx) => ctx.step("validate", () => validateData(userData)),
    async (ctx) => ctx.step("transform", () => transformData(userData)),
  ]);

  return { success: true, results };
};

export const handler = withDurableExecution(durableHandler);
```

## Example 2

\*\*With Custom Configuration:\*\*

```typescript
import { LambdaClient } from "@aws-sdk/client-lambda";

const customClient = new LambdaClient({
  region: "us-west-2",
  maxAttempts: 5,
});

export const handler = withDurableExecution(durableHandler, {
  client: customClient,
});
```

## Example 3

\*\*Passed Directly to the Handler:\*\*

```typescript
export const handler = withDurableExecution(async (event, context) => {
  const result = await context.step(async () => processEvent(event));
  return result;
});
```
