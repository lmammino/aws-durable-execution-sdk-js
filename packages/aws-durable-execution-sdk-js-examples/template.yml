AWSTemplateFormatVersion: '2010-09-09'
Description: Durable Function examples written in TypeScript.
Transform:
  - AWS::Serverless-2016-10-31
Resources:
  BlockExample:
    Type: AWS::Serverless::Function
    Properties:
      FunctionName: BlockExample-TypeScript
      CodeUri: ./dist
      Handler: block-example.handler
      Runtime: nodejs22.x
      Architectures:
        - x86_64
      MemorySize: 128
      Timeout: 60
      DurableConfig:
        ExecutionTimeout: 3600
        RetentionPeriodInDays: 7
      Environment:
        Variables:
          AWS_ENDPOINT_URL_LAMBDA: http://host.docker.internal:5000
          DURABLE_VERBOSE_MODE: 'true'
    Metadata:
      SkipBuild: 'True'
  ComprehensiveOperations:
    Type: AWS::Serverless::Function
    Properties:
      FunctionName: ComprehensiveOperations-TypeScript
      CodeUri: ./dist
      Handler: comprehensive-operations.handler
      Runtime: nodejs22.x
      Architectures:
        - x86_64
      MemorySize: 128
      Timeout: 60
      DurableConfig:
        ExecutionTimeout: 3600
        RetentionPeriodInDays: 7
      Environment:
        Variables:
          AWS_ENDPOINT_URL_LAMBDA: http://host.docker.internal:5000
          DURABLE_VERBOSE_MODE: 'true'
    Metadata:
      SkipBuild: 'True'
  ConcurrentOperations:
    Type: AWS::Serverless::Function
    Properties:
      FunctionName: ConcurrentOperations-TypeScript
      CodeUri: ./dist
      Handler: concurrent-operations.handler
      Runtime: nodejs22.x
      Architectures:
        - x86_64
      MemorySize: 128
      Timeout: 60
      DurableConfig:
        ExecutionTimeout: 3600
        RetentionPeriodInDays: 7
      Environment:
        Variables:
          AWS_ENDPOINT_URL_LAMBDA: http://host.docker.internal:5000
          DURABLE_VERBOSE_MODE: 'true'
    Metadata:
      SkipBuild: 'True'
  ConcurrentWait:
    Type: AWS::Serverless::Function
    Properties:
      FunctionName: ConcurrentWait-TypeScript
      CodeUri: ./dist
      Handler: concurrent-wait.handler
      Runtime: nodejs22.x
      Architectures:
        - x86_64
      MemorySize: 128
      Timeout: 60
      DurableConfig:
        ExecutionTimeout: 3600
        RetentionPeriodInDays: 7
      Environment:
        Variables:
          AWS_ENDPOINT_URL_LAMBDA: http://host.docker.internal:5000
          DURABLE_VERBOSE_MODE: 'true'
    Metadata:
      SkipBuild: 'True'
  CreateCallback:
    Type: AWS::Serverless::Function
    Properties:
      FunctionName: CreateCallback-TypeScript
      CodeUri: ./dist
      Handler: create-callback.handler
      Runtime: nodejs22.x
      Architectures:
        - x86_64
      MemorySize: 128
      Timeout: 60
      DurableConfig:
        ExecutionTimeout: 3600
        RetentionPeriodInDays: 7
      Environment:
        Variables:
          AWS_ENDPOINT_URL_LAMBDA: http://host.docker.internal:5000
          DURABLE_VERBOSE_MODE: 'true'
    Metadata:
      SkipBuild: 'True'
  HelloWorld:
    Type: AWS::Serverless::Function
    Properties:
      FunctionName: HelloWorld-TypeScript
      CodeUri: ./dist
      Handler: hello-world.handler
      Runtime: nodejs22.x
      Architectures:
        - x86_64
      MemorySize: 128
      Timeout: 60
      DurableConfig:
        ExecutionTimeout: 3600
        RetentionPeriodInDays: 7
      Environment:
        Variables:
          AWS_ENDPOINT_URL_LAMBDA: http://host.docker.internal:5000
          DURABLE_VERBOSE_MODE: 'true'
    Metadata:
      SkipBuild: 'True'
  Index:
    Type: AWS::Serverless::Function
    Properties:
      FunctionName: Index-TypeScript
      CodeUri: ./dist
      Handler: index.handler
      Runtime: nodejs22.x
      Architectures:
        - x86_64
      MemorySize: 128
      Timeout: 60
      DurableConfig:
        ExecutionTimeout: 3600
        RetentionPeriodInDays: 7
      Environment:
        Variables:
          AWS_ENDPOINT_URL_LAMBDA: http://host.docker.internal:5000
          DURABLE_VERBOSE_MODE: 'true'
    Metadata:
      SkipBuild: 'True'
  MapBasic:
    Type: AWS::Serverless::Function
    Properties:
      FunctionName: MapBasic-TypeScript
      CodeUri: ./dist
      Handler: map-basic.handler
      Runtime: nodejs22.x
      Architectures:
        - x86_64
      MemorySize: 128
      Timeout: 60
      DurableConfig:
        ExecutionTimeout: 3600
        RetentionPeriodInDays: 7
      Environment:
        Variables:
          AWS_ENDPOINT_URL_LAMBDA: http://host.docker.internal:5000
          DURABLE_VERBOSE_MODE: 'true'
    Metadata:
      SkipBuild: 'True'
  ParallelBasic:
    Type: AWS::Serverless::Function
    Properties:
      FunctionName: ParallelBasic-TypeScript
      CodeUri: ./dist
      Handler: parallel-basic.handler
      Runtime: nodejs22.x
      Architectures:
        - x86_64
      MemorySize: 128
      Timeout: 60
      DurableConfig:
        ExecutionTimeout: 3600
        RetentionPeriodInDays: 7
      Environment:
        Variables:
          AWS_ENDPOINT_URL_LAMBDA: http://host.docker.internal:5000
          DURABLE_VERBOSE_MODE: 'true'
    Metadata:
      SkipBuild: 'True'
  ParallelWait:
    Type: AWS::Serverless::Function
    Properties:
      FunctionName: ParallelWait-TypeScript
      CodeUri: ./dist
      Handler: parallel-wait.handler
      Runtime: nodejs22.x
      Architectures:
        - x86_64
      MemorySize: 128
      Timeout: 60
      DurableConfig:
        ExecutionTimeout: 3600
        RetentionPeriodInDays: 7
      Environment:
        Variables:
          AWS_ENDPOINT_URL_LAMBDA: http://host.docker.internal:5000
          DURABLE_VERBOSE_MODE: 'true'
    Metadata:
      SkipBuild: 'True'
  PromiseAll:
    Type: AWS::Serverless::Function
    Properties:
      FunctionName: PromiseAll-TypeScript
      CodeUri: ./dist
      Handler: promise-all.handler
      Runtime: nodejs22.x
      Architectures:
        - x86_64
      MemorySize: 128
      Timeout: 60
      DurableConfig:
        ExecutionTimeout: 3600
        RetentionPeriodInDays: 7
      Environment:
        Variables:
          AWS_ENDPOINT_URL_LAMBDA: http://host.docker.internal:5000
          DURABLE_VERBOSE_MODE: 'true'
    Metadata:
      SkipBuild: 'True'
  PromiseAllSettled:
    Type: AWS::Serverless::Function
    Properties:
      FunctionName: PromiseAllSettled-TypeScript
      CodeUri: ./dist
      Handler: promise-all-settled.handler
      Runtime: nodejs22.x
      Architectures:
        - x86_64
      MemorySize: 128
      Timeout: 60
      DurableConfig:
        ExecutionTimeout: 3600
        RetentionPeriodInDays: 7
      Environment:
        Variables:
          AWS_ENDPOINT_URL_LAMBDA: http://host.docker.internal:5000
          DURABLE_VERBOSE_MODE: 'true'
    Metadata:
      SkipBuild: 'True'
  PromiseAny:
    Type: AWS::Serverless::Function
    Properties:
      FunctionName: PromiseAny-TypeScript
      CodeUri: ./dist
      Handler: promise-any.handler
      Runtime: nodejs22.x
      Architectures:
        - x86_64
      MemorySize: 128
      Timeout: 60
      DurableConfig:
        ExecutionTimeout: 3600
        RetentionPeriodInDays: 7
      Environment:
        Variables:
          AWS_ENDPOINT_URL_LAMBDA: http://host.docker.internal:5000
          DURABLE_VERBOSE_MODE: 'true'
    Metadata:
      SkipBuild: 'True'
  PromiseCombinators:
    Type: AWS::Serverless::Function
    Properties:
      FunctionName: PromiseCombinators-TypeScript
      CodeUri: ./dist
      Handler: promise-combinators.handler
      Runtime: nodejs22.x
      Architectures:
        - x86_64
      MemorySize: 128
      Timeout: 60
      DurableConfig:
        ExecutionTimeout: 3600
        RetentionPeriodInDays: 7
      Environment:
        Variables:
          AWS_ENDPOINT_URL_LAMBDA: http://host.docker.internal:5000
          DURABLE_VERBOSE_MODE: 'true'
    Metadata:
      SkipBuild: 'True'
  PromiseRace:
    Type: AWS::Serverless::Function
    Properties:
      FunctionName: PromiseRace-TypeScript
      CodeUri: ./dist
      Handler: promise-race.handler
      Runtime: nodejs22.x
      Architectures:
        - x86_64
      MemorySize: 128
      Timeout: 60
      DurableConfig:
        ExecutionTimeout: 3600
        RetentionPeriodInDays: 7
      Environment:
        Variables:
          AWS_ENDPOINT_URL_LAMBDA: http://host.docker.internal:5000
          DURABLE_VERBOSE_MODE: 'true'
    Metadata:
      SkipBuild: 'True'
  RunInChildContext:
    Type: AWS::Serverless::Function
    Properties:
      FunctionName: RunInChildContext-TypeScript
      CodeUri: ./dist
      Handler: run-in-child-context.handler
      Runtime: nodejs22.x
      Architectures:
        - x86_64
      MemorySize: 128
      Timeout: 60
      DurableConfig:
        ExecutionTimeout: 3600
        RetentionPeriodInDays: 7
      Environment:
        Variables:
          AWS_ENDPOINT_URL_LAMBDA: http://host.docker.internal:5000
          DURABLE_VERBOSE_MODE: 'true'
    Metadata:
      SkipBuild: 'True'
  StepBasic:
    Type: AWS::Serverless::Function
    Properties:
      FunctionName: StepBasic-TypeScript
      CodeUri: ./dist
      Handler: step-basic.handler
      Runtime: nodejs22.x
      Architectures:
        - x86_64
      MemorySize: 128
      Timeout: 60
      DurableConfig:
        ExecutionTimeout: 3600
        RetentionPeriodInDays: 7
      Environment:
        Variables:
          AWS_ENDPOINT_URL_LAMBDA: http://host.docker.internal:5000
          DURABLE_VERBOSE_MODE: 'true'
    Metadata:
      SkipBuild: 'True'
  StepNamed:
    Type: AWS::Serverless::Function
    Properties:
      FunctionName: StepNamed-TypeScript
      CodeUri: ./dist
      Handler: step-named.handler
      Runtime: nodejs22.x
      Architectures:
        - x86_64
      MemorySize: 128
      Timeout: 60
      DurableConfig:
        ExecutionTimeout: 3600
        RetentionPeriodInDays: 7
      Environment:
        Variables:
          AWS_ENDPOINT_URL_LAMBDA: http://host.docker.internal:5000
          DURABLE_VERBOSE_MODE: 'true'
    Metadata:
      SkipBuild: 'True'
  StepWithRetry:
    Type: AWS::Serverless::Function
    Properties:
      FunctionName: StepWithRetry-TypeScript
      CodeUri: ./dist
      Handler: step-with-retry.handler
      Runtime: nodejs22.x
      Architectures:
        - x86_64
      MemorySize: 128
      Timeout: 60
      DurableConfig:
        ExecutionTimeout: 3600
        RetentionPeriodInDays: 7
      Environment:
        Variables:
          AWS_ENDPOINT_URL_LAMBDA: http://host.docker.internal:5000
          DURABLE_VERBOSE_MODE: 'true'
    Metadata:
      SkipBuild: 'True'
  StepsWithRetry:
    Type: AWS::Serverless::Function
    Properties:
      FunctionName: StepsWithRetry-TypeScript
      CodeUri: ./dist
      Handler: steps-with-retry.handler
      Runtime: nodejs22.x
      Architectures:
        - x86_64
      MemorySize: 256
      Timeout: 300
      DurableConfig:
        ExecutionTimeout: 3600
        RetentionPeriodInDays: 7
      Environment:
        Variables:
          AWS_ENDPOINT_URL_LAMBDA: http://host.docker.internal:5000
          DURABLE_VERBOSE_MODE: 'true'
      Policies:
        - DynamoDBReadPolicy:
            TableName: TEST
    Metadata:
      SkipBuild: 'True'
  Wait:
    Type: AWS::Serverless::Function
    Properties:
      FunctionName: Wait-TypeScript
      CodeUri: ./dist
      Handler: wait.handler
      Runtime: nodejs22.x
      Architectures:
        - x86_64
      MemorySize: 128
      Timeout: 60
      DurableConfig:
        ExecutionTimeout: 3600
        RetentionPeriodInDays: 7
      Environment:
        Variables:
          AWS_ENDPOINT_URL_LAMBDA: http://host.docker.internal:5000
          DURABLE_VERBOSE_MODE: 'true'
    Metadata:
      SkipBuild: 'True'
  WaitForCallback:
    Type: AWS::Serverless::Function
    Properties:
      FunctionName: WaitForCallback-TypeScript
      CodeUri: ./dist
      Handler: wait-for-callback.handler
      Runtime: nodejs22.x
      Architectures:
        - x86_64
      MemorySize: 128
      Timeout: 60
      DurableConfig:
        ExecutionTimeout: 3600
        RetentionPeriodInDays: 7
      Environment:
        Variables:
          AWS_ENDPOINT_URL_LAMBDA: http://host.docker.internal:5000
          DURABLE_VERBOSE_MODE: 'true'
    Metadata:
      SkipBuild: 'True'
  WaitForCondition:
    Type: AWS::Serverless::Function
    Properties:
      FunctionName: WaitForCondition-TypeScript
      CodeUri: ./dist
      Handler: wait-for-condition.handler
      Runtime: nodejs22.x
      Architectures:
        - x86_64
      MemorySize: 128
      Timeout: 60
      DurableConfig:
        ExecutionTimeout: 3600
        RetentionPeriodInDays: 7
      Environment:
        Variables:
          AWS_ENDPOINT_URL_LAMBDA: http://host.docker.internal:5000
          DURABLE_VERBOSE_MODE: 'true'
    Metadata:
      SkipBuild: 'True'
  WaitNamed:
    Type: AWS::Serverless::Function
    Properties:
      FunctionName: WaitNamed-TypeScript
      CodeUri: ./dist
      Handler: wait-named.handler
      Runtime: nodejs22.x
      Architectures:
        - x86_64
      MemorySize: 128
      Timeout: 60
      DurableConfig:
        ExecutionTimeout: 3600
        RetentionPeriodInDays: 7
      Environment:
        Variables:
          AWS_ENDPOINT_URL_LAMBDA: http://host.docker.internal:5000
          DURABLE_VERBOSE_MODE: 'true'
    Metadata:
      SkipBuild: 'True'
